\documentclass[a4paper,10pt]{amsart}
\usepackage{kubik}

\begin{document}
\title{On the total curvature of \\
minimizing geodesics on convex surfaces}
\author{Nina Lebedeva}
\address{N. Lebedeva\newline\vskip-4mm
Math. Dept.
St. Petersburg State University,
Universitetsky pr., 28, 
Stary Peterhof, 
198504, Russia.
\newline\vskip-4mm
Steklov Institute,
27 Fontanka, St. Petersburg, 
191023, Russia.}
\email{lebed@pdmi.ras.ru}
\author{Anton Petrunin}
\address{A. Petrunin\newline\vskip-4mm
Math. Dept. PSU,
University Park, PA 16802,
USA}
\email{petrunin@math.psu.edu}
\thanks{N.~Lebedeva was partially supported by RFBR grant 
14-01-00062.}
\thanks{A.~Petrunin was partially supported by NSF grant DMS 1309340.}


\date{}

\begin{abstract}
We give a universal upper bound 
for the total curvature 
of minimizing geodesic 
on a convex surface 
in the Euclidean space.
\end{abstract}
\subjclass{53A05, 53C45, 53C22}
\maketitle

\section{Introduction}


Denote by $\EE^3$ the 3-dimensional Euclidean space.

Recall that the \emph{total curvature} of a curve $\gamma\:[0,\ell]\to \EE^3$ 
(briefly $\tc\gamma$)
is defined as supremum of sum of exterior angles 
for the broken lines inscribed in $\gamma$.
If $\gamma$ is smooth and equipped with the natural parameter, 
then 
\[\tc\gamma=\int\limits_0^\ell \kappa(t)\cdot dt,\]
where $\kappa(t)=|\gamma''(t)|$ is the curvature of $\gamma$ at $t$.

\begin{thm}{Main theorem}\label{thm:main}
If $K$ is a closed convex set in the 3-dimensional Euclidean space,
$\Sigma$ is the surface of $K$ 
and $\gamma$ be a minimizing geodesic in $\Sigma$
then 
\[\tc\gamma\le \omega,\]
where $\omega$ is a universal real constant.
\end{thm}

The question was stated in \cite{AH-PSV}, \cite{pach} and \cite{BKZ},
but we have learned it from Dmitry Burago only few years ago.

Let us briefly discuss the related results.

\begin{itemize}
\item In \cite{liberman}, Liberman gives a bound on the turn of short geodesic in terms of the ratio diameter and inradius of $K$.
In the proof he use now so called Liberman's lemma \ref{lem:liberman} discussed below.
This statement was rediscovered in \cite{BKZ}.
\item In \cite{usov}, 
Usov gives the optimal bound for total curvature of geodesic on the graph of $\ell$-Lipscitz convex function. 
Namely, he proves that if $f\:\RR^2\to\RR$ is $\ell$-Lipschitz and convex then any 
geodesic in its graph 
\[\Gamma_f=\set{(x,y,z)\in \RR^3}{z=f(x,y)}\] 
has turn at most $2\cdot \ell$.
This statement was also rediscovered in \cite{BKZ}.
Yet an amusing generalization of Usov's result is given by Berg in \cite{berg}.
\item In \cite{pogorelov}, Pogorelov conjectured that any the spherical image of geodesic on convex surface has to be contructable.
It is easy to see that the length of spherical image of geodesic can not be smaller than its total curvature, 
so this conjecture (if it would be true) 
would be stronger than Liberman's theorem.
Counterexamples were found indepenently by Milka in \cite{milka}, 
Usov in \cite{usov-conj-pog} 
and much later by Pach in \cite{pach}.
\item In \cite{BKZ},
B{\'a}r{\'a}ny,
Kuperberg, 
and Zamfirescu 
have constructed a corkscrew minimizing geodesic on a closed hypersurface;
that is a minimizing geodesic which twists around given line arbitrary many times.

\item In the same paper they also constructed a minimizing geodesic on a convex surface in $\RR^3$
with total curvature bigger that $2\cdot\pi$.
(Note that $2\cdot\pi$ is the optimal bound for the analogous problem in the plane.)
\end{itemize}

\parbf{Plan of the proof.}
We prove is divided in three steps.

First we prove a sequence of propositions which alow us to consider only special case of surfaces and curves.
Namely we show that we can assume that
\begin{enumerate}[(i)]
\item\label{smooth}{\it (Proposition \ref{prop:smooth}).} 
The surface $\Sigma$ is $C^\infty$-smooth.
\item{\it (Proposition \ref{prop:almost-const}).}  The $z$-component of $\gamma'$ is positive,
\item\label{graph}{\it (Proposition \ref{prop:graph}).} The surface $\Sigma$ is formed by a graph $z=f(x,y)$ of a smooth convex function $f\:\RR^2\to \RR$.
\end{enumerate}

On the second step we give number of geometric inequalities which relate the angles between $\gamma'(t)$ and with the coordinate axis.

The last step in the proof is purely algebraic, 
here we combine the obtained inequalities to give a universal bound on the total curvature 
of $\gamma_n$ 
which satisfies the conditions (\ref{smooth})--(\ref{graph}).


\section{Preliminaries}

Let $\Sigma$ be a convex hypersurface in the Euclidean space.

Given a point $p\in \Sigma$, we will denote by $n_p$ the outer normal vector of $\Sigma$ at $p$;
the map $\Sigma\to\SS^2$ defined as $p\mapsto n_p$ sometimes is called \emph{Gauss map}.

Fix a points $z\notin\Sigma$.
Given a point $p\in \Sigma$,
we say that $p$ lies on light (dark) side from $z$ if 
if $\langle z-p,n_p\rangle\le 0$ (correspondingly $\langle z-p,n_p\rangle\ge 0$).
If $\langle z-p,n_p\rangle= 0$ we say that $p$ lies on the horizon
from $p$.
Note that if $z$ lies inside of $\Sigma$ then all points on $\Sigma$ lie on the dark side from $z$.

Let $\gamma$ be a space curve 
parametrized by length.
Fix a point $z\notin\gamma$. 
Let us define \emph{Liberman's development} of $\gamma$ with respect to $z$ as the unit-speed plane cure $\tilde\gamma_z$ such that the direction $\tilde\gamma_z(t)$
changes counterclockwise as $t$ changes
and
$|\tilde\gamma_p(t)|=|\gamma(t)-z|$ for any $t$.

The Liberman's development $\tilde\gamma_z$ is called convex concave at $\tilde\gamma_z(t)$ if there the curvelinear triangle ??? 


\begin{thm}{Liberman lemma}\label{lem:liberman}
Let $\Sigma$ be a convex surface in the Euclidean space 
$z\not\in\Sigma$ and $\gamma$ be a unit-speed geodesic in $\Sigma$.
Then the development $\tilde\gamma_z$ is locally convex (concave) 
at the points on dark (light) side of $\Sigma$ with respect to $z$.
\end{thm}

Assume $\gamma\:[0,\ell]\to \Sigma$ is a unit-speed curve in the space.

The vector $\gamma''(t)$ is the curvature vector of $\gamma$ at $t$.
The total curvature of $\gamma$ can be defined as 
\[\tc\gamma\df\int\limits_0^\ell|\gamma''(t)|\cdot dt.\]

The total curvature of $\tilde\gamma_z$ 
is called the total curvature of $\gamma$ in the direction of $z$ 
and denoted as $\tc_z\gamma$
Given a point $z$, let us define the total curvature of $\gamma$ in the direction of $z$ as
\[\tc_z\gamma
\df
\int\limits_0^\ell
\left|
\langle\gamma''(t),\tfrac{z-\gamma(t)}{|z-\gamma(t)|}\rangle
\right|
\cdot dt.\]

\begin{thm}{Key Lemma}
\label{lem:key}
Let $\gamma\:[0,\ell]\to \Sigma$ be a geodesic on the convex surface in the Euclidean space 
and $u\in\SS^2$.
Assume that $0=t_0<t_1<\dots<t_n=\ell$ be the values such that each arcs $\gamma|_{[t_{i-1},t_i]}$ alternating light and dark side of $\Sigma$ with respect to $u$.
Set $\alpha_i=\measuredangle(\gamma'(t_i),u)$
Then 
\[\tc_u\gamma=|\sum_i(-1)^i\alpha_i|.\]

Moreover, if $1<i<n$ 
and $\Omega_i$ denotes the domain of $\Sigma$ bounded by the arc $\gamma|_{[t_{i-1},t_i]}$ and the $u$-horizon then 
\[|\alpha_i-\alpha_{i-1}|\le \curv\Omega_i,\]
where $\curv\Omega_i$ denotes the total curvature of $\Omega_i$.
In particular,
\[\tc_u\gamma\le 4\cdot\pi+\sum_i\curv\Omega_i.\]
\end{thm}

\parbf{Remarks.}
Clearly $\tc_z\gamma\le \tc \gamma$ for any curve $\gamma$ in $\Sigma$.

On the other hand given few points $z_i$ which do not lie in one plane
one can estimate $\tc\gamma$ 
in terms of $\tc_{z_i}\gamma$ 
the distances between $z_i$ and the maximal distance to $\gamma$.

Let $N=N(\Sigma,\gamma, u)$ be the maximal integer such that at most $N$ of the domains $\Omega_i$ intersect at one point.
Note that from \cite{BKZ}, it follows that the value $N$ can take arbitrary large value.
The number $N$ can be estimated through the maximal rotation number of subarcs of $\gamma$ with respect to the lines.
In particular the total curvature of geodesic $\gamma$ 
can be bounded in terms of maximal rotation number of subarcs of $\gamma$ around the lines.
The later was claimed in \cite{BKZ} without a proof.

Then
\[\sum_{i=2}^{n-1}\curv\Omega_i
\le 
N\cdot\curv\Sigma
\le 
4\cdot N\cdot\pi.\]
Therefore, we get an estimate
\[\tc_u\gamma
\le 
4\cdot N\cdot\pi+|\alpha_0-\alpha_1|+|\alpha_{n-1}-\alpha_n|
\le
(4\cdot N+2)\cdot\pi.\]
Since the same holds for any vector $u$,
we can taking avarage we get
\[\tc\gamma\le 3\cdot(4\cdot N+2)\cdot\pi.\]


\section{Smoothing}

\begin{thm}{Proposition}\label{prop:smooth}
Let $K_1,K_2,\dots,K_\infty$ be closed convex sets in $\RR^3$
and $K_n\to K_\infty$ in the sense of Hausdorff.
Then for any minimizing geodesic $\gamma_\infty$ in the surface of $K_\infty$
there is a a sequence of minimizing geodesics $\gamma_n$ in the surface of $K_n$ such that  $\gamma_n\to\gamma_\infty$.
\end{thm}

\parit{Proof.}
Assume $\gamma$ is a minimizing geodesic on a convex surface $\Sigma$.
Assume $\gamma$ parametrized by its length $[0,\ell]$.
We can choose a subinterval $[a,b]\subset [0,\ell]$
such that $0<a$ and $b<\ell$
and $\tc(\gamma|_{[a,b]})$ is arbitrary close to the $\tc \gamma$.

Set $p=\gamma(a)$ and $q=\gamma(b)$.

Assume $\Sigma_n$ be a sequence of smooth convex surfaces converging to $\Sigma$.
and $p_n,q_n\in\Sigma_n$ be a two sequences of points which converge to $p$ and $q$ 
correspondingly.

Denote by $\gamma_n$ a minimizing geodesic from $p_n$ to $q_n$ in $\Sigma_n$.
Note that $\gamma_n$ converges to $\gamma|_{[a,b]}$
as $n\to\infty$.
\qeds

\section{Length and diameter}

Let $\eps>0$.
A curve $\gamma\:[a,b]\to\RR^3$ will be called $\eps$-straight
if 
\[\length \gamma\le e^\eps\cdot|\gamma(b)-\gamma(a)|\]

\begin{thm}{Lemma}\label{lem:eps-straight}
Given $\eps>0$ there is $\delta>0$ (any  $\delta<(1-e^{-\eps})/2$ will do)
such that
in any minimizing geodesic of length $\ell$
on a convex surface $\Sigma$ in $\RR^3$ there an $\eps$-straight arc of length at least $\delta\cdot\ell$;
\end{thm}

\parit{Proof.}
Set $\alpha=\arccos e^{-\eps}$.
Let $N$ be the maximal number of points in $\mathbb S^2$ which lie on distance at least $2\cdot\alpha$ from each other.

Let $\gamma\:[0,\ell]\to \Sigma$ be a minimizing geodesic parametrized by its length.

Given a value $t\in [0,\ell]$,
set $t'$ to be the maximal value in $[0,\ell]$ such that the interval $[t,t']$ i $\eps$-straight.

Consider the maximal sequence $0=t_0<t_1<\dots<t_n<\ell$
such that $t_{i+1}=t_i'$.

Denote by $\nu_i$ the outer unit normal vector to $\Sigma$ at $\gamma(t_i)$. 
Note that $\measuredangle(\nu_i,\nu_j)>2\cdot\alpha$ for all $i$ and $j$.
It follows that the sequence $(t_i)$ terminates after at most $N$ steps.
Therefore any $\delta<\tfrac1{N+1}$ does the job.
\qeds


\begin{thm}{Lemma}\label{lem:diam-length}
Assume $\gamma$ is a minimizing geodesic on a convex surface in $\RR^3$.
Then 
\[\length\gamma< 4\cdot\diam \gamma.\]
\end{thm}

\parit{Proof.}
Assume contrary;
that is, 
there is convex surface $\Sigma\subset\RR^3$
and a geodesic $\gamma\:[0,4]\to \Sigma$ 
is parametrized by its length with $\diam \gamma\le 1$.

Denote by $\nu_0$, $\nu_2$ and $\nu_4$ the outer unit normal vectors
to $\Sigma$ at $\gamma(0)$, $\gamma(2)$ and $\gamma(4)$ correspondingly.

Note that $\measuredangle(\nu_0,\nu_2), \measuredangle(\nu_2,\nu_4)\ge\tfrac23\cdot\pi$ and $\measuredangle(\nu_0,\nu_2)>\tfrac23\cdot\pi$,
a contradiction.
\qeds



\section{Reduction to a monotonic case}

In this section we show that to prove the Main theorem,
it is sufficient to consider only the geodesics which go almost in one direction.
The following proposition will be applied to $\eps=\tfrac\pi4$;
in this case one can take $\delta=10^{-10}$.

\begin{thm}{Proposition}\label{prop:almost-const}
Given $\eps>0$ there is $\delta>0$
such that the following statement holds.

If $\gamma\:[0,\ell]\to\Sigma$ is a minimizing geodeisc 
on a smooth convex surface $\Sigma$ in $\RR^3$
then there is an interval $[a,b]\subset[0,\ell]$
such that \[\tc(\gamma|_{[a,b]}>\delta\cdot\tc\gamma.\]
and 
\[\measuredangle(\gamma'(t),u)<\eps\] 
for any $t\in[a,b]$
and a fixed unit vector $u$.
\end{thm}

\parit{Proof.}
Note that total curvature is lower semicontinuous on the space of curves.
Therefore, by Proposition~\ref{prop:smooth}, we can assume that $\Sigma_n$ are smooth.

Applying rescaling, we can assume that $\diam\gamma=1$.
By Lemma \ref{lem:diam-length} $\length\gamma_n\zz<4$.
Therefore we can subdivide $\gamma$ into say 100000 arcs
such that the legth of each arc is at most $\tfrac1{100}$
and it lies on the distance $\tfrac12\pm \tfrac1{100}$ 
from a point $p\in K_n$.
Choose among them the arc with the maximal total curvature and 
name it $\bar\gamma$ and translate whole space so the corresponding point $p$ becomes the origin.
Clearly
\[\tc\bar\gamma>\tfrac1{100000}\cdot \tc\gamma.\]

Fix $N>\tfrac2\eps$.
Applying Liberman's Lemma to $\bar\gamma$ with the origin as the reference point 
we get that \[\tc_0\gamma_n<\pi+\tfrac1{10}.\]
Therefore we can divide $\bar\gamma$ into $N$ arcs 
so that for each arc $\bar{\bar\gamma}$
we have \[\tc_p\bar{\bar\gamma}\le \tfrac{\pi+\tfrac1{10}}{N}.\]
Coose among these arcs the one with maximal total curvature,
denote it further by $\bar{\bar\gamma}$.
Clearly 
\[\tc\bar{\bar\gamma}>\tfrac\eps{1000}\cdot \tc\bar\gamma.\]

Fix a parameter $t$ of $\bar{\bar\gamma}$
and denote by $\alpha$ the angle between $\bar{\bar\gamma}'(t)$ and $p-\bar{\bar\gamma}(t)$.

If $\alpha<\tfrac\eps2$ or $alpha>\pi-\tfrac\eps2$,
then the problem is solved.

Otherwise 
applying Lemma \ref{lem:eps-straight} we get a nondegenerate (say equilateral) 
triangle $\triangle a_1a_2a_3$ in $K_n$ 
of the size comparable to $\diam \bar\gamma$ 
and on the distance comparable to $\diam \gamma$ from any point of $\bar\gamma$,
say side of triangle can be taken to be $\tfrac{\eps^2}{1000}\cdot\diam \bar\gamma$
and the distance to any point can be assumed to be between $\diam \bar\gamma$ and $2\cdot \diam \bar\gamma$

Apply the construction to each vertex of the triangle.
We pass to an arc of $\hat\gamma$
such that the angle between $\hat\gamma'(t)$ and $a_i-\hat\gamma(t)$ 
and the distance $|\hat\gamma(t)-a_i|$
are nearly constant for each $i$.
The later imply that $\hat\gamma'$ is nearly constant.
\qeds


\section{Angle estimates}

Fix a $(x,y,z)$-coordinates on the Euclidean space.
The lines parallel to the $z$-axis will be called \emph{vertical};
the lines and planes parallel to $(x,y)$-plane will be called \emph{horizontal}.

Given a vector $\bm{\upsilon}\in\RR^3$, we will denote by $\upsilon_x$, $\upsilon_y$ and $\upsilon_z$ its components.
Set 
\[\bm{e}_x=(1,0,0),\ \ \bm{e}_y=(0,1,0)\ \ \text{and}\ \ \bm{e}_z=(0,0,1).\]

Let $\Sigma$ be a convex surface 
and $\gamma\:[0,\ell]\to \Sigma$ is a minimizing geodesic 
with unit-speed parametrization.

Given $t\in [0,\ell]$, 
consider the oriented orthonormal frame $\lambda(t),\mu(t),\nu(t)$ 
such that $\nu(t)$ is the outer normal to $\Sigma$ at $\gamma(t)$,
the vector $\mu(t)$ is horizontal and therefore the vector $\lambda(t)$ lies in the plane spanned by $\nu(t)$ and the $z$-axis.

\begin{thm}{Observation}
According to Proposition~\ref{prop:almost-const},
we can assume that $\gamma'_z(t)>0$ for any $t$
and both ends of $\gamma$ lie on the $z$-axis.
\end{thm}

In particular, $\nu(t)$ can not be vertical 
and therefore the frame $(\lambda,\mu,\nu)$ is uniquely defined for any $t\in[0,\ell]$.



After rotating $(x,y)$-plane if necessary, 
we can assume that the border of shadow in the directions of $x$-axis, say $\omega_x$, 
is a smooth curve and $\gamma$ intersects them transversely.

Let $t_1<t_2<\dots<t_k$ be the time moments in $[0,\ell]$ 
at which $\gamma$ intersects $\omega_x$.
Note that 
\[\mu(t_n)=s_n\cdot e_x\ \ \text{for some}\ \  s_n=\pm1.\]

Further denote by $\alpha(t)$ the signed angle between $\gamma'(t)$ and $\lambda(t)$ in the tangent plane at $\gamma(t)$.
Since $\gamma'_z>0$,
we can (and will) 
assume that $\alpha(t)$ takes values in $(-\tfrac\pi2,\tfrac\pi2)$.
Set 
\[\alpha_n=\alpha(t_n).\]

Note that  
\begin{align*}
\tc_{\bm{e}_x} \gamma
&\le 
2\cdot\pi+\tc_{\bm{e}_x}\left(\gamma|_{[t_1,t_k]}\right)=
\\
&=2\cdot\pi+\left|\sum s_n\cdot \alpha_n\right|.
\end{align*}

Consider yet two more angle functions.
\begin{itemize}
\item Let $\phi(t)$ be the angle between $\gamma'(t)$ and $z$-axis. Set $\phi_n=\phi(t_n)$.
\item Let $\psi(t)$ be the signed angle between $\nu(t)$ and $(x,y)$-plane. 
Set $\psi_n=\psi(t_n)$.
\end{itemize}
Note that 
\[\phi(t)\ge |\psi(t)|\ \ \text{and}\ \  \phi(t)\ge |\alpha(t)|\] 
for any $t$.
In particular 
\[\phi_n\ge |\psi_n|\ \ \text{and}\ \  \phi_n\ge |\alpha_n|\]
for any $n$.

\parbf{Horizontal rotation.}
Note that $\mu(t)$ is horizontal for any $t$.

Define the rotation $\rho[a,b]$  
of the interval $[a,b]\subset[0,\ell]$
as the
algebraic rotation of $\mu(t)$ around the origin in $(x,y)$-plane;
say it can be defined by the formula 
\[\rho_{[a,b]}
=
\int\limits_a^b \<\mu(t),\mathrm{J}(\mu'(t))\>\cdot dt,\]
where $\mathrm{J}\:\RR^2\to\RR^2$ denotes the rotation by angle $\tfrac\pi 2$ around the origin.

Note that 
\[\rho[t_i,t_{i+1}]=\tfrac\pi2\cdot(s_i+s_{i+1}).\]

\begin{thm}{Claim}
Assume that 
\[\gamma_z(t_i)\ge \tfrac12\cdot(\gamma_z(\ell)+\gamma_z(0))\ \ \text{and}\ \ \left|\sum_{n=i}^js_n\right|=4.\]
Then $\psi(t)>0$ for any $t\ge t_j$.
\end{thm}

Note that the claim implies that from $t_j$,
the geodesic $\gamma$ 
lies on a graph $z=f(x,y)$ of a concave function $f\:\RR^2\to\RR$
and forms a minimizing geodesic in this graph.
Indeed fix $\eps>0$ such that $\psi(t)>\eps$
for any $t\ge t_j$.
Consider the set $W$ which lies under all the supporting planes 
such that its outer normal vector forms angle at most 
$\tfrac\pi2-\eps$ with the vertical direction.
Note that the set $W$ forms a subgraph $z\le f(x,y)$ 
of a  concave $(\mathop{\rm ctg} \eps)$-Lipschitz function $f\:\RR^2\to \RR$
and all the points of $\gamma$ lie the graph $z=f(x,y)$

\parit{Proof.}
Assume contrary, that is $\phi(t)\le 0$ for some $t\ge t_j$.
Let us draw the half-plane $\Pi$ through $\gamma(t)$ bounded by the $z$-axis.
Note that $\Pi$ intesects the arc $\gamma|_{[t_i,t_j]}$ at some point say 
$\gamma(t')$.
Consider the sub-arc $\sigma$ 
of $\Sigma\cap\Pi$ from $\gamma(t)$
to $z$.
Since $\gamma$ is minimizing we have that 
\[\length \gamma|_{[t',t]}\le \length\sigma.\]
Straightforward computations lead to a contradiction.
\qeds

Note that the last claim imply the following.

\begin{thm}{Proposition}\label{prop:graph}
Assume Main Theorem does not hold;
that is, there is a sequence of convex surfaces $\Sigma_n$
and a sequence of minimizing geodesic $\gamma_n$ in $\Sigma_n$ such that 
\[\tc \gamma_n\to\infty\ \ \text{as}\ \ n\to\infty.\]

Then we can make in addition one of the following assumtions:

\begin{enumerate}[(i)]
\item\label{graph} $\Sigma_n$ is a graph $z=f_n(x,y)$ of a smooth convex function $f_n\:\RR^2\to\RR$
and $\gamma'_z(t)>0$ for any $t\in[0,\ell]$. 
\item\label{finite} $\left|\sum_{n=i}^js_n\right|<10$ for any $i<j$.
\end{enumerate} 
\end{thm}

In particular, from now on $\psi(t)>0$ for any $t\in[0,\ell]$.
Note also that by Liberman's lemma $\phi(t)$ is a nondecreasing function on $[0,\ell]$.
The two cases (\ref{graph}) and (\ref{finite}) will be done separetely.
The case (\ref{graph}) is more involved.

\begin{thm}{Claim}
Let $[a,b]\subset[0,\ell]$ and $\rho[a,b]\ge 3\cdot\pi$.
Then $\psi(t)\ge \phi(a)$ for any $t\ge b$.
\end{thm}


\begin{thm}{Claim}
Assume  
$\psi(t)\ge \eps>0$ for any $t\in [a,b]$.
Then 
$\alpha(b)-\alpha(a)>\eps\cdot\rho[a,b]$.
In particular, either $|\alpha(a)|>\tfrac12\cdot\eps\cdot\rho[a,b]$ or $|\alpha(b)|>\tfrac12\cdot\eps\cdot\rho[a,b]$.
\end{thm}

Note that above two claims imply the following.

\begin{thm}{Proposition}
Assume $\gamma$ as in Proposition \ref{prop:graph}
and for some $i<j$ we have
\[\left|\sum_{n=i}^js_i\right|=5\]
Then $\phi_j>2\cdot\phi_i$.
\end{thm}



\section{The sum estimate}

There is no geometry in this section.
Here we give an estimate for a sum 
of finite sequence of real numbers 
of a very specific form.


Assume a finite  sign-sequence $\bm{s}=(s_1,\dots, s_k)$
is given;
that is $s_i=\pm1$ for $i$.

We say that a pair of indexes $i< j$
forms an \emph{$\bm{s}$-pair} 
if 
\begin{align*}
\sum_{n=i}^js_n&=0&&
\text{and}&
\sum_{n=i}^{j'}s_n&>0
\end{align*} 
if $i<j'<j$.

Note that for any index $i$ appears in at most one $\bm{s}$-pair and 
for any $\bm{s}$-pair $(i,j)$ we have
\begin{itemize}
\item $s_i=1$; that is, $i$-th braket has to be openning.
 \item $s_j=-1$; that is, $j$-th braket has to be closing.
\end{itemize}

\parbf{Bracket interpretation.}
If you exchange ``$+1$'' and ``$-1$'' in $\bm{s}$ by ``$($'' and ``$)$'' correspondingly then $(i,j)$ is an $\bm{s}$-pair
if and only if the $i$-th bracket forms a pair with $j$-bracket.

\medskip

We say that $q$ is the depth of an $\bm{s}$-pair $(i,j)$
(briefly $q=\depth_{\bm{s}}(i,j)$) 
if $q$ is the maximal number such that theis $q$-long nested sequence of $\bm{s}$-pairs starting with $(i,j)$; 
that is a sequence of $\bm{s}$-pairs
$(i,j)=(i_1,j_1),(i_2,j_2),\dots,(i_q,j_q)$ such that
\[i=i_1<\dots<i_q<j_q<\dots<j_1=j.\]

\begin{thm}{Proposition}
Assume that
\begin{itemize}
\item $s_1,\dots, s_k$ is a sign sequence,
\item $0\le K_1\le K_2\le \dots\le K_k$.
\item a sequence $\alpha_1,\dots,\alpha_k$ is such that for $\bm{s}$-pair $(i,j)$, we have
\[|\alpha_i-\alpha_j|\le \depth_{\bm{s}}(i,j)\cdot(K_j-K_i),\]
\item $0\le \phi_1\le\dots\le\phi_k$ such that $\phi_i\ge |\alpha_i|$ for any $i$ and $\phi_j>2\cdot\phi_i$ for any $j>i$ such that $|\sum_{n=i}^js_n|=5$.
\end{itemize}
Then
\[|\sum s_n\cdot \alpha_n|\le 20\cdot( K_k+ \phi_k).\]

\end{thm}

\parit{Proof.}
Note that for arbitrary the $\bm{s}$-pairs $(i,j)$ and $(i',j')$
we have three possibllities:
\begin{itemize}
\item $[i,j]\subset [i',j']$ and in this case $\depth_{\bm{s}}(i,j)<\depth_{\bm{s}}(i',j')$;
\item $[i,j]\supset [i',j']$ and in this case $\depth_{\bm{s}}(i,j)>\depth_{\bm{s}}(i',j')$;
\item $[i,j]\cap [i',j']=\emptyset$.
\end{itemize}
In partcular, if $\depth_{\bm{s}}(i,j)=\depth_{\bm{s}}(i',j')$ then the intervals $[i,j]$ and $[i',j']$ do not overlap.


Therefore if 
\[S_q=\sum_{\depth_{\bm{s}}(i,j)=q} (\alpha_i-\alpha_j)\] 
is the sum for all $\bm{s}$-pairs with depth $q$ then 
\[|S_q|\le q\cdot K_k.\]

Since $s_i=1$ and $s_j=-1$ for any $\bm{s}$-pair $(i,j)$,
we have
\[\alpha_i-\alpha_j=s_i\cdot\alpha_i+s_j\cdot\alpha_j.\]
That is, one can partition $\{1,\dots,k\}$ into two sets, say $H$ and $G$ such that
\[S_1+S_2+S_3+S_4+S_5=\sum_{i\in H}s_i\cdot \alpha_i\] 

An index $i$ belongs to $G$ 
if it does not form an $\bm{s}$-pair 
or its $\bm{s}$-pair has depth at least $6$.
Let us subdivide $G$ into 5 groups, say $G_1,\dots,G_5$ 
so $i$ and $j$ go into the same group if 
\[\sum_{n=i}^j s_n\equiv 0\pmod 5.\]

Note that
\begin{align*}
|\sum_{n\in G_m}s_n\cdot \alpha_n|
&\le \sum_{n\in G_m}\phi_n\le
\\
&\le 2\cdot\phi_k;
\end{align*}
the last inequality follows since $(\phi_i)$ is an increasing sequence 
and
$\phi_j>2\cdot \phi_i$
if $i,j\in G_m$ and $i<j$.

Summarizing
\begin{align*}
|\sum_n s_n\cdot\alpha_n|&\le 
\sum_{i=1}^5|S_i|
+
\sum_{i=1}^5\left|\sum_{n\in G_i} s_n\cdot\alpha_n\right|\le
\\
&\le 15\cdot K_k+10\cdot \phi_k.
\end{align*}
Hence the result follows.
\qeds


\sloppy
\printbibliography[heading=bibintoc]
\fussy

\end{document}
