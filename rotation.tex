\documentclass[a4paper,10pt]{amsart}
\usepackage{kubik}

\begin{document}
\title{On the total curvature of \\
minimizing geodesics on convex surfaces}
\author{Nina Lebedeva}
\address{N. Lebedeva\newline\vskip-4mm
Math. Dept.
St. Petersburg State University,
Universitetsky pr., 28, 
Stary Peterhof, 
198504, Russia.
\newline\vskip-4mm
Steklov Institute,
27 Fontanka, St. Petersburg, 
191023, Russia.}
\email{lebed@pdmi.ras.ru}
\author{Anton Petrunin}
\address{A. Petrunin\newline\vskip-4mm
Math. Dept. PSU,
University Park, PA 16802,
USA}
\email{petrunin@math.psu.edu}
\thanks{N.~Lebedeva was partially supported by RFBR grant 
14-01-00062.}
\thanks{A.~Petrunin was partially supported by NSF grant DMS 1309340.}


\date{}

\begin{abstract}
We give a universal upper bound 
for the total curvature 
of minimizing geodesic 
on a convex surface 
in the Euclidean space.
\end{abstract}
\subjclass{53A05, 53C45, 53C22}
\maketitle

\section{Introduction}

\begin{thm}{Main theorem}\label{thm:main}
The total curvature of a minimizing geodesic
on a convex surface in $\RR^3$ can not exceed $10^{10}$.
\end{thm}

The main theorem was stated as an open question in \cite{AH-PSV}, \cite{pach} and \cite{BKZ}, but we have learned it from Dmitry Burago only few years ago.

Let us briefly discuss the related results.

\begin{itemize}
\item In \cite{liberman}, Liberman gives a bound on the total curvature of short geodesic in terms of the ratio diameter and inradius of $K$.
In the proof he use now so called Liberman's lemma \ref{lem:liberman} discussed below.
This statement was rediscovered in \cite{BKZ}.
\item In \cite{usov}, 
Usov gives the optimal bound for total curvature of geodesic on the graph of $\ell$-Lipscitz convex function. 
Namely, he proves that if $f\:\RR^2\to\RR$ is $\ell$-Lipschitz and convex then any 
geodesic in its graph 
\[\Gamma_f=\set{(x,y,z)\in \RR^3}{z=f(x,y)}\] 
has total curvature at most $2\cdot \ell$.
This statement was also rediscovered in \cite{BKZ}.
Yet an amusing generalization of Usov's result is given by Berg in \cite{berg}.
\item In \cite{pogorelov}, Pogorelov conjectured that any the spherical image of geodesic on convex surface has to be contructable.
It is easy to see that the length of spherical image of geodesic can not be smaller than its total curvature, 
so this conjecture (if it would be true) 
would be stronger than Liberman's theorem.
Counterexamples were found indepenently by Milka in \cite{milka}, 
Usov in \cite{usov-conj-pog} 
and yet much later rediscovered by Pach in \cite{pach}.
\item In \cite{BKZ},
B{\'a}r{\'a}ny,
Kuperberg, 
and Zamfirescu 
have constructed a corkscrew minimizing geodesic on a closed hypersurface;
that is a minimizing geodesic which twists around given line arbitrary many times.
In the same paper they also constructed a minimizing geodesic on a convex surface in $\RR^3$
with total curvature bigger that $2\cdot\pi$.
(Note that $2\cdot\pi$ is the optimal bound for the analogous problem in the plane.)
\end{itemize}


\section{Preliminaries}

\parbf{Semicontinuity of total curvature.}
Recall that the \emph{total curvature} of a curve $\gamma\:[0,\ell]\to \RR^3$ 
(briefly $\tc\gamma$)
is defined as supremum of sum of exterior angles 
for the polygonal lines inscribed in $\gamma$.

Note that for a polygonal line $\sigma$, 
its total curvature coinside with the sum of its exterior angles.

If $\gamma$ is a smooth curve with unit-speed parametrization, 
then 
\[\tc\gamma=\int\limits_0^\ell \kappa(t)\cdot dt,\]
where $\kappa(t)=|\ddot\gamma(t)|$ is the curvature of $\gamma$ at $t$.

\begin{thm}{Proposition}
Assume $\gamma_n\:\II\to\RR^3$ is a sequence of curves  converging pointwise to a curve $\gamma_\infty\:\II\to\RR^3$.
Then 
\[\liminf_{n\to\infty}\tc\gamma_n\ge \tc\gamma_\infty.\]
\end{thm}


\parit{Proof.}
Choose a polygonal line $\sigma_\infty$ inscribed in $\gamma_\infty$ with total curvature sufficiently close to $\tc\gamma_\infty$.
Let $\gamma_\infty(t_0),\dots\gamma_\infty(t_k)$ be the vertices of $p_\infty$
Consider the polygonal lines $\sigma_n$ with the vertices 
$\gamma_n(t_0)\dots\gamma_n(t_k)$.
Note that 
\[\tc\sigma_n\to\tc\sigma_\infty.\]
Hence the statement follows.
\qeds

\parbf{Convergence.}
Given a closed set $\Sigma\subset \RR^3$,
denote by $\dist_\Sigma$ the distance function from $\Sigma$;
that is 
\[\dist_\Sigma(x)=\inf\set{|x-y|}{y\in\Sigma}.\]

We say that a sequence of closed sets $\Sigma_n\subset \RR^3$
converges to the closed set $\Sigma_\infty\subset \RR^3$ 
if for any $x\in\RR^3$,
we have
$\dist_{\Sigma_n}(x)\to\dist_{\Sigma_\infty}(x)$ as $n\to\infty$.


\parbf{Convex surfaces.}
By convex surface in the Euclidean 3-space $\RR^3$ we understand the boundary of closed convex set with nonempty interior.

\begin{thm}{Proposition}
Assume $\Sigma_n$ be a sequence of convex surfaces which converge to a convex surface $\Sigma_\infty$.
Then for any minimizing geodesic $\gamma_\infty$ in $\Sigma_\infty$ there is a sequence of minimizing geodesics $\gamma_n$ in $\Sigma_n$ which pointwise converge to $\gamma_\infty$ as $n\to \infty$.
\end{thm}

\parit{Proof.}
Assume $\gamma_\infty$ parametrized by its length $[0,\ell]$.

Fix a subinterval $[a,b]\subset [0,\ell]$
such that $0<a$ and $b<\ell$.
Set $p_\infty=\gamma_\infty(a)$ and $q_\infty=\gamma_\infty(b)$.

Let $p_n,q_n\in\Sigma_n$ be a two sequences of points which converge to $p_\infty$ and $q_\infty$ 
correspondingly.

Denote by $\gamma_n$ a minimizing geodesic from $p_n$ to $q_n$ in $\Sigma_n$.
Note that $\gamma_n$ converges to $\gamma_\infty|_{[a,b]}$
as $n\to\infty$.

Taking the subinterval  $[a,b]$ closer and closer to $[0,\ell]$
and applying diagonal procedure, we get the result.
\qeds

\section{Liberman's lemma.}

In this section we give a slight generalization 
of the construction of Liberman in \cite{liberman}.

\parbf{Development.}
Let $\gamma\:[0,\ell]\to\RR^3$ be a curve parametrized by length
and a point $p$ does not lie on $\gamma$.

Assume  $\tilde\gamma_p\:[0,\ell]\to\RR^2$ is a plane curve parametrized by length
and $\tilde p$ is a point in the plane such that 
\[|\tilde p-\tilde\gamma(t)|=|\tilde p-\tilde\gamma(t)|\]
for any $t\in[0,\ell]$ and the direction from $\tilde p$ to $\tilde \gamma(t)$ changes counterclockwise. 
Then $\tilde\gamma_p$ is called \emph{development} of $\gamma$ with respect to $p$.

We say that the development $\tilde\gamma_p$ is convex in the interval $[a,b]$
if the curvelinear triangle bounded by arc $\tilde\gamma|_{[a,b]}$
and the segments $[\tilde p\tilde\gamma(a)]$, $[\tilde p\tilde\gamma(a)]$
is convex. 
Correspondly we say that $\tilde\gamma$ is convex in the interval $[a,b]$
if the complement of this triangle in the angle bounded by half-lines $[\tilde p\tilde\gamma(a))$ and $[\tilde p\tilde\gamma(b))$
 is convex.

We say that $\tilde\gamma_p$ is locally convex (concave) in the interval $[a,b]$
if any point $x\in [a,b]$ admits a closed neighborhood $[a',b']$ in $[a,b]$
such that $\tilde\gamma_p$ is convex (correspondingly concave) in the interval $[a',b']$.

If we pass to the limit of this construction as $p$ moves to infinity along a half-line in the derection of a unit vector $\bm{u}$ then the limit curve is called development of $\gamma$ in direction $u$ and denoted as $\tilde\gamma_u$.

The development $\tilde\gamma_u$ could be also defined directly.
Namely assume a curve $\tilde\gamma_{u}\:[0,\ell]\to \R^2$
is parametrized by length and
and for a fixed unit vector $\tilde u\in\RR^2$,
we have
\[\langle \tilde u,\tilde\gamma_u(t)\rangle=\langle  u,\gamma_u(t)\rangle\]
for any $t\in [0,\ell]$
and the projection of $\tilde\gamma_u(t)$ to the line normal to $\tilde u$
is monotonic in $t$.
Then the curve $\tilde\gamma_u$ is called development of $\gamma$ in the direction $u$.

We can assume that $\tilde u$ is the vertical vector in the coordinate plane.
In this case $\tilde\gamma_u$ is a graph of a function $y=f(x)$
defined in some real inteval.
We say that $\tilde\gamma_u$ is concave (convex) in the interval $[a,b]$ 
if the function $f$ is concave (correspondingly convex) in the corresponding real interval.
 
\parbf{Dark and light sides.}
Let $\Sigma\subset\RR^3$ be a smooth convex surface 
and $z\notin\Sigma$ and $p\in\Sigma$.

We say that $p$ lies on the dark (light) side of $\Sigma$ with from $z$ 
if all the points $p+t\cdot(p-z)$ lie outside of $\Sigma$ for $t>0$ (correspondingly for $t<0$).
The intesection of dark and light side is called horizon of $z$;
it is denoted by $\omega_z$.

Note that if $z$ lies inside $\Sigma$ then all the points on $\Sigma$ lies on dark side from $z$.

If $\Sigma$ is smooth we can define the outer normal vector $\nu_p$ to $\Sigma$ at $p$.
In this case $p$ lies on dark (light) side of $\Sigma$ with from $z$
if and only if $\langle z-p,\nu_p\rangle\ge 0$
(correspondingly for $\langle z-p,\nu_p\rangle\le 0$).
If in addition $\Sigma$ is strongly convex then the horizon is formed by a collection of disjont smooth curves.

We could also define light/dark sides and horizon in the limit case,
if $p$ escapes to infinity along a half-line in derection $u$.
Let us also define it derectly,
we say that a point $p\in\Sigma$ lies on dark (light) side for the unit vector $u$ if all the points $p+u\cdot t$ lie outside of $\Sigma$ for all $t>0$, (correspondingly $t<0$).
As before the intesection of light and dark side is called horizon and denoted by $\omega_u$.

In the smooth case the later means that $\langle \nu_p,u\rangle\ge 0$ (correspondingly $\langle \nu_p,u\rangle\le 0$).
If $\Sigma$ is strongley convex then $\omega_u$ is locally a smooth curve.

\begin{thm}{Liberman's Lemma}\label{lem:liberman}
Assume $\gamma$ be a geodesic on convex surface $\Sigma\subset \RR^3$.
Then for any point $z\notin\Sigma$ the development $\tilde\gamma_z$ is locally convex (locally concve) if $\gamma$ lies on dark (correspondingly light) side of $\Sigma$ from $z$.

Similarly for any unit vector $u$,
the development $\tilde\gamma_u$ is locally convex (locally concve) if $\gamma$ lies on dark (correspondingly light) side of $\Sigma$ for $u$.

\end{thm}

Note that for any space curve $\gamma$ and any unit vector $\bm{u}$
we have 
\[\tc\tilde\gamma_{\bm{u}}\le\tc\gamma.\]
On the other hand total curvature of few developments gives an estimate 
for the total curvature of the original curve.
For example if $\bm{i},\bm{j},\bm{k}$ is the orthonormal basis then
\[\tc\gamma
\le
\tc\tilde\gamma_{\bm{i}}+\tc\tilde\gamma_{\bm{j}}+\tc\tilde\gamma_{\bm{k}}.\]

If $\gamma$ lies on one dark or light side for direction $\bm{u}$
then by Liberman's lemma we get 
\[\tc\tilde\gamma_{\bm{u}}\le \pi.\]
It follows that is $\gamma$ cross the horisons $\omega_{\bm{i}}$, $\omega_{\bm{j}}$ and $\omega_{\bm{k}}$
at most $N$ times then 
\begin{align*}
\tc\gamma
&\le
\tc\tilde\gamma_{\bm{i}}
+\tc\tilde\gamma_{\bm{j}}
+\tc\tilde\gamma_{\bm{k}}
\le
\\
&\le(N+1)\cdot \pi.
\end{align*}
Therefore if $\gamma$ violetes Main Theorem then it has to cross the  horisons $\omega_{\bm{i}}$, $\omega_{\bm{j}}$ and $\omega_{\bm{k}}$ more that $10^9$ times.

\begin{thm}{Corollary}
Let $\Sigma\subset\RR^3$
be a strongly convex smooth surface
and $\gamma\:[0,\ell]\to \Sigma$ be a unitspeed geodesic.
Assume that for some unit vector $u$,
the $\gamma$ cross the horizon $\omega_u$ tranversally at 
$t_1<\dots t_k$.
Set $\alpha_i=\measuredangle(\dot\gamma(t_i),u)$ for each $i$.
Then
\[\tc_{u}\gamma\le 3\cdot\pi+2\cdot|\alpha_1-\alpha_2+\dots -(-1)^k\cdot\alpha^k|\]

\end{thm}

Most of the remaining part of paper devoted to finding an
estimate for
\[|\alpha_1-\alpha_2+\dots -(-1)^k\cdot\alpha^k|.\]

\parit{Proof.}
By Liberman's lemma,
\[\tc_{u}(\gamma|_{[t_i,t_{i+1}]}=\pm(\alpha_i-\alpha_{i+1})\]
where we have $+$ sign if $[t_i,t_{i+1}]$ lies on the dark side from $u$ and $-$ if it lies on the light side.
Summing all this up we get
\[\tc_{u}(\gamma|_{[t_1,t_{k}]}=\alpha_1-2\cdot\alpha_2-\dots+(-1)^k\cdot2\cdot\alpha_{k-1}-(-1)^k\cdot\alpha_k.\]
By Liberman's lemma we also have
\[\tc_u(\gamma|_{[0,t_1]}),\tc_u(\gamma|_{[t_k,\ell]})\le \pi \]
Since $|\alpha_i|\le\tfrac\pi 2$, the statement follows.
\qeds 


\section{Key Lemma}

Let $\Sigma$ be a smooth strongly convex surface in $\RR^3$.
Given a unit vector $\bm{u}$,
denote by $\omega_{\bm{u}}$ the $\bm{u}$-horizon on $\Sigma$.

Let $\gamma\:[a,b]\to\Sigma$ be a geodesic wich lies completely 
on the dark side
and both ends 
$\gamma(a)$ and $\gamma(b)$ lie on $\omega_{\bm{u}}$.

Set $\alpha=\measuredangle(\dot\gamma(a),\bm{u})-\tfrac\pi2$ and $\beta=\measuredangle(\dot\gamma(b),\bm{u})-\tfrac\pi2$.

Assume $\Omega$ is one of the discs which 
$\gamma$ cuts from the dark side of $\Sigma$.


Then 
\[\int\limits_\Omega K\cdot d\area\]
takes one of the following four values 
$\alpha-\beta$, $2\cdot\pi-(\alpha-\beta)$, 
$\pi\pm(\alpha+\beta)$.

Note that $\tc_{\bm{u}}\gamma=\alpha-\beta$
therefore in all 4 cases we have
\[\tc_{\bm{u}}\gamma\le\int\limits_\Omega K\cdot d\area.\]

\section{Snake and spirals}

Formally speaking, this section is not needed;
it only shows how to use Key Lemma in the simplest case
and explains the difficulty in the general case.


This observation makes possible to estimate $\tc_{\bm{u}}\gamma$
if $\gamma$ cross $\omega_{\bm{u}}$ as shown on the picture.
That is, points $\gamma(t_1),\dots,\gamma(t_k)$
lie in the same order oncross $\omega_{\bm{u}}$.
\begin{center}
\begin{lpic}[t(1 mm),b(1 mm),r(0 mm),l(0 mm)]{pics/horizon-geodesic(1)}
\lbl[t]{5,5.5;$\gamma(0)$}
\lbl[bl]{16,14;$\gamma(t_0)$}
\lbl[b]{40.5,18,3;$\dots$}
\lbl[br]{66,16.5;$\gamma(t_k)$}
\lbl[t]{73,12;$\gamma(\ell)$}
\lbl[tl]{29,4;$\omega_u$}
\lbl[]{24.5,8;$\Omega_1$}
\lbl[]{56,10;$\Omega_k$}
\end{lpic}
\end{center}
In this case we can chhose nonoverlaping discs $\Omega_1,\dots,\Omega_k$ which $\gamma$ cuts from light and dark side alternatively.
Then estimates above sho that 
\begin{align*}
\tc_{\bm{u}}\gamma
&=\tc_{\bm{u}}(\gamma|_{[0,t_0]})
+\tc_{\bm{u}}(\gamma|_{[t_0,t_1]})+\dots
\\
&\ \ \ \ \dots+\tc_{\bm{u}}(\gamma|_{[t_{k-1},t_k]})+\tc_{\bm{u}}(\gamma|_{[t_k,\ell]})\le
\\
&\le \pi+K(\Omega_1)+\dots+K(\Omega_k)+\pi\le
\\
&\le 6\cdot\pi.
\end{align*}
The last integuality holds since the discs $\Omega_i$ do not overlap and by Gauss--Bonnet we have $K(\Sigma)\le 4\cdot\pi$.

\begin{wrapfigure}{r}{35 mm}
\begin{lpic}[t(-5 mm),b(0 mm),r(0 mm),l(0 mm)]{pics/spiral(1)}
\end{lpic}
\end{wrapfigure}

This gives the first idea that the Key Lemma might be useful.
It does not help that easily if the $\gamma$ cross $\omega$ in a different order, say as the spiral shown on the picture.
For any arc $\gamma|_{[t_{i-1},t_i}$ we have tow choose one of two discs as $\Omega_i$,
but they will always overlap.

\section{Length and diameter}

Let $\eps>0$.
A curve $\gamma\:[a,b]\to\RR^3$ will be called $\eps$-straight
if 
\[(1-\eps)\cdot\length \gamma\le |\gamma(b)-\gamma(a)|\]

\begin{thm}{Lemma}\label{lem:eps-straight}
Assume $\eps>0$ 
and $n$ is a positive integer such that
$2\cdot n\cdot\eps>1$.
Then any 
in any minimizing geodesic
on a convex surface $\Sigma$ in $\RR^3$
can be sudivided into twenty  $\tfrac1{10}$-straight arcs.
\end{thm}

\parit{Proof.}
Assume two points $p$ and $q$ lie on a canovex surface $\Sigma$.
Denote by $\nu_p$ and $\nu_q$ the outer normal vectors at $p$ and $q$ correspondingly.
Set $\alpha=\measuredangle(\nu_p,\nu_q)$ and  $\eps=1-\cos\tfrac\alpha2$.

Note that any minimizing geodesic geodesic from $p$ to $q$ on $\Sigma$
is $\eps$-straight.

It follows that if two points $p$ and $q$ on $\Sigma$ can be jointed by an minimizing geodesic which is not $\tfrac1{10}$-straight
then the 

Note that there are at most $\tfrac2{1-e^{-\eps}}$ points in $\mathbb S^2$ which lie on distance at least $2\cdot\alpha$ from each other.

Let $\gamma\:[0,\ell]\to \Sigma$ be a minimizing geodesic parametrized by its length.

Given a value $t\in [0,\ell]$,
set $t'$ to be the maximal value in $[0,\ell]$ such that the interval $[t,t']$ is $\tfrac1{10}$-straight.

Consider the maximal sequence $0=t_0<t_1<\dots<t_n<\ell$
such that $t_{i+1}=t_i'$.
Denote by $\nu_i$ the outer unit normal vector to $\Sigma$ at $\gamma(t_i)$. 

Note that $\measuredangle(\nu_i,\nu_j)>2\cdot\alpha$ for all $i$ and $j$.
It follows that $n<\tfrac2{1-e^{-\eps}}$.
Hence the problem follows.
\qeds


\begin{thm}{Lemma}\label{lem:diam-length}
Assume $\gamma$ is a minimizing geodesic on a convex surface in $\RR^3$.
Then 
\[\length\gamma< 4\cdot\diam \gamma.\]
\end{thm}

\parit{Proof.}
Assume contrary;
that is, 
there is convex surface $\Sigma\subset\RR^3$
and a geodesic $\gamma\:[0,4]\to \Sigma$ 
is parametrized by its length with $\diam \gamma\le 1$.

Denote by $\nu_0$, $\nu_2$ and $\nu_4$ the outer unit normal vectors
to $\Sigma$ at $\gamma(0)$, $\gamma(2)$ and $\gamma(4)$ correspondingly.

Note that $\measuredangle(\nu_0,\nu_2), \measuredangle(\nu_2,\nu_4)\ge\tfrac23\cdot\pi$ and $\measuredangle(\nu_0,\nu_2)>\tfrac23\cdot\pi$,
a contradiction.
\qeds



\section{Reduction to a monotonic case}

\begin{thm}{Proposition}\label{prop:almost-const}
Let $\gamma\:[0,\ell]\to\Sigma$ be a minimizing geodeisc 
on a smooth strongly convex surface $\Sigma$ in $\RR^3$.
Then there is an interval $[a,b]\subset[0,\ell]$
such that 
\[\tc(\gamma|_{[a,b]}>\tfrac1{100}\cdot\tc\gamma.\]
and 
\[\measuredangle(\dot\gamma(t),\bm{u})<\tfrac\pi3\] 
for any $t\in[a,b]$
and a fixed unit vector $\bm{u}$.
\end{thm}

The proof will use the following claim.
It states that 
if a short smooth unit-speed curve runs at nearly the same rate from the vertices of triangle then it runs in nearly the same direction.

\begin{thm}{Claim}
Given $\eps>0$ there is $\delta>0$ such that the following condition holds.

Assume $\gamma$ is a smooth unit-speed curve 
in the unit ball $B\subset\RR^3$.
Assume 
$\length\gamma<\delta$ 
and $B$ contains an equilateral triangle with vertices $x_1,x_2,x_3$ with sides $\eps$
and for some fixed numbers
$\alpha_1,\alpha_2,\alpha_3$
for any $i$
we have either
\[|\gamma(t)-x_i|\le \tfrac\eps{10}\ \ \text{or}\ \ \measuredangle(x_i-\gamma(t),\dot\gamma(t))\lege \alpha_i\pm\delta\]
for any $t$.
Then there is a unit vector $u$ such that
\[\measuredangle(\dot\gamma(t),u)\le\tfrac\pi3\]

Moreover if $\eps=\tfrac1{100}$ 
then one can take $\delta=\tfrac1{10000}$.
\end{thm}

The proof is straightforward calculations
and it is left to the reader.

\parit{Proof.}
Applying rescaling, we can assume that $\diam\gamma=3$.
By Lemma \ref{lem:diam-length} $\length\gamma_n\zz<12$.
Therefore we can subdivide $\gamma$ into $12$ 
arcs $\gamma_1,\dots,\gamma_{12}$
such that for each $n$ there is a point $p_n\in K$ 
which lies on the distance at least $1$ from $\gamma_n$ and $\length\gamma_n\le 1$.
Choose
an arc $\gamma'=\gamma_n$ with the maximal total curvature 
and set $p'=p_n$.
Clearly
\[\tc\gamma'\ge\tfrac1{12}\cdot\tc\gamma.\]


Applying Liberman's Lemma to $\gamma'$ with  the reference point $p'$ 
we get that 
\[\tc\tilde\gamma'_{p'}<\pi+1<5.\]

Choose an integer $N>\tfrac2\eps$.
Note that we can divide $\gamma'$ into $N$ arcs 
$\gamma'_1,\dots,\gamma'_N$
so that 
\[\tc_{p'}\gamma_n'\le \tfrac{5}{N}\]
for each $n$.
Choose among these arcs the one with maximal total curvature,
denote it further by $\gamma''$.
Clearly 
\[\tc\gamma''>\tfrac\eps{10^3}\cdot \tc\gamma'.\]

Fix a parameter $t$ of $\gamma''$
and denote by $\alpha$ the angle between $\dot\gamma''(t)$ and $p-\gamma''(t)$.

If $\alpha<\tfrac\eps2$ or $\alpha>\pi-\tfrac\eps2$,
then the problem is solved.

Otherwise 
applying Lemma \ref{lem:eps-straight} we get a nondegenerate (say equilateral) 
triangle $\triangle a_1a_2a_3$ in $K_n$ 
of the size comparable to $\diam \gamma'$ 
and on the distance comparable to $\diam \gamma'$ from any point of $\gamma''$,
say side of triangle can be taken to be $\tfrac{\eps^2}{1000}\cdot\diam \bar\gamma$
and the distance to any point can be assumed to be between $\diam \bar\gamma$ and $2\cdot \diam \bar\gamma$

Apply the construction to each vertex of the triangle.
We pass to an arc of $\hat\gamma$
such that the angle between $\dot\gamma(t)$ and $a_i-\gamma(t)$ 
and the distance $|\gamma(t)-a_i|$
are nearly constant for each $i$.
The later imply that $\dot\gamma$ is nearly constant.
\qeds





\section{Elevating geodesics}\label{sec:elevating}

In this section we fix notations which will be used further 
without additional explanation.

Fix a $(x,y,z)$-coordinates on the Euclidean space;
denote by $(\bm{i},\bm{j},\bm{k})$
the standard basis.

The lines parallel to the $z$-axis will be called \emph{vertical};
the lines and planes parallel to $(x,y)$-plane will be called \emph{horizontal}.

\begin{thm}{Definition}
A smooth curve $\gamma\:[0,\ell]\to\RR^3$ 
is called \emph{elevating} if both ends $\gamma(0)$ and $\gamma(\ell)$ lie on the $z$-axiz and $\langle\dot\gamma(t),\bm{k}\rangle>0$ for all $t$.
\end{thm}

\parbf{$\bm{(\lambda,\mu,\nu)}$-frame.}
Let $\Sigma$ be a convex surface 
and $\gamma\:[0,\ell]\to \Sigma$ is an elevating minimizing geodesic 
with unit-speed parametrization.

Given $t\in [0,\ell]$, 
consider the oriented orthonormal frame $\lambda(t),\mu(t),\nu(t)$ 
such that $\nu(t)$ is the outer normal to $\Sigma$ at $\gamma(t)$,
the vector $\mu(t)$ is horizontal and therefore the vector $\lambda(t)$ lies in the plane spanned by $\nu(t)$ and the $z$-axis.
We assume in addition that $\langle\lambda,\bm{k}\rangle\ge 0$.

Since $\langle\dot\gamma(t),\bm{k}\rangle>0$, 
$\nu(t)$ can not be vertical 
and therefore the frame $(\lambda,\mu,\nu)$ is uniquely defined for any $t\in[0,\ell]$.

\parbf{Angle functions.}
Set 
\begin{align*}
\phi(t)&=\measuredangle(\bm{k},\dot\gamma(t)),&
\psi(t)&=\tfrac\pi2-\measuredangle(\bm{k},\nu(t)),&
\alpha(t)&=\tfrac\pi2-\measuredangle(\mu(t),\dot\gamma(t)),
\end{align*}

From the above definitions it follows that $|\alpha(t)|,|\psi(t)|\le \tfrac\pi2$ and for each $t$ there is a right spherical triangle with legs $|\alpha(t)|,|\psi(t)|$ and hypotenuse $\phi(t)$.
In particular $\cos\alpha\cdot\cos\psi=\cos\phi$.
Whence we get the following.

\begin{thm}{Claim}
For any $t$ we have 
\[
\phi(t)\ge |\psi(t)|\ \ \text{and}\ \ \phi(t)\ge |\alpha(t)|
\]

\end{thm}

Applying Liberman's Lemma in the direction $\bm{k}$ we also get the following.

\begin{thm}{Claim}
If an arc $\gamma|_{[a,b]}$ lies in the dark (light) side for $\bm{k}$ then 
the function $\phi$ is nondecreasing (correspondingly nonincreasing)
in $[a,b]$.
\end{thm}

\section{Plane sections}

Assume $\gamma$ is a curve on a smooth strictly convex surface $\Sigma$ in $\RR^3$.
Consider a plane $L$ 
passing through two points of $\gamma$, 
say $p=\gamma(a)$ and $q=\gamma(b)$ with $a<b$.
Let $L_\pm$ be a  half-planes in $L$ bounded by the line trough $p$ and $q$.
Set $\sigma_\pm=\Sigma\cap L_\pm$;
note that $\sigma_\pm$ are a smooth convex plane curve connecting $p$ to $q$ in $\Sigma$.

\begin{thm}{Observation}\label{obs:cut}
If $\gamma$ is a minimizing geodesic in the convex surface $\Sigma\subset \RR^3$ and $a$, $b$ and $\sigma_\pm$ as above then
\[\length\sigma_\pm\ge\length(\gamma|_{[a,b]}).\]
\end{thm}

Based on this observation we give couple of estimates on elevating minimizing geodesics.

\begin{thm}{Propostion}\label{prop:around-once}
Assume $\gamma\:[0,\ell]\to \Sigma$ is an elevating minimizing geodesic in the convex surface $\Sigma\subset \RR^3$.
Assume that for a subsegment $[a,b]\subset [0,\ell]$ the following conditions hold
\begin{enumerate}[(i)]
\item The points $\gamma(a)$ and $\gamma(b)$ lie in a half-plane with boundary line formed by the $z$-axis
and  the arc $\gamma|_{[a,b]}$ goes around the $z$-axis at least once.
\item $\gamma(a)$ lies above the horizontal plane through $\tfrac12\cdot(\gamma(0)+\gamma(\ell))$.
\end{enumerate}
Then  $\gamma(b)$ lies on the dark side of $\Sigma$ with respect to $\bm{k}$.
\end{thm}

\parit{Proof.} 
Let us apply Observation~\ref{obs:cut} to the plane containing $z$-axis, $\gamma(a)$ and $\gamma(b)$.


We can assume that $\gamma(0)$ is the origin of the $(x,y,z)$-coordinate system
and both points $p=\gamma(a)$ and $q=\gamma(b)$ lie in the $(x,z)$-coordinate half-plane with $x\ge 0$, denoted by $\Pi$.
We can assume that $\sigma_+\subset \Pi$.
Let $(x_p,0,z_p)$ and $(x_q,0,z_q)$ be the coordinates of $p$ and $q$.

From the assumptions we get $z_p<z_q<2\cdot z_p$.

By convexity of the curve $\Pi\cap \Sigma$
we get 
\[\length\sigma_+\le \sqrt{(z_q-z_p)^2+x_p^2}\]

On the other hand, since $\gamma|_{[a,b]}$ goes around $z$-axis at least once,
we get 
\[\length\gamma|_{[a,b]}\ge \sqrt{(z_q-z_p)^2+(x_p+x_q)^2}.\]

These two estimates contradict Observation~\ref{obs:cut}.
\qeds

\begin{thm}{Corollary}\label{cor:around-twice}
If $\Sigma$, $\gamma$, $\ell$, $a$ and $b$ as in the Proposition and the arc $\gamma|_{[a,b]}$ goes around the $z$-axis at least twice
then the arc $\gamma|_{[b,\ell]}$ lies on the dark side with respect to $\bm{k}$.
\end{thm}

\parit{Proof.} 
Fix $b'\in [b,\ell]$.
Note that one can find $a'\in [a,b]$ such that the the assumtions of Proposition~\ref{prop:around-once} hold for the interval $[a',b']$. Applying Proposition we get the result.\qeds 


\begin{thm}{Propostion}\label{prop:phi-psi}
Assume $\gamma\:[0,\ell]\to \Sigma$ is elevating minimizing geodesic in the convex surface $\Sigma\subset \RR^3$.
Assume that the arc $\gamma|_{[b,\ell]}$ lies in the dark side of $\Sigma$ with respect to $\bm{k}$.
Set $\phi(t)=\measuredangle(\bm{k},\dot\gamma(t))$ and $\psi(t)=\tfrac\pi2-\measuredangle(\bm{k},\nu(t))$.
If $b\le s<t\le \ell$ and the point $\gamma(s)$ lies in the plane $\Pi$ through $\gamma(t)$ spanned by $\nu(t)$ and $\lambda(t)$
then 
\[\phi(s)\le \psi(t).\]
\end{thm}

\parit{Proof.}
Let us apply Observation~\ref{obs:cut} to the plane $\Pi$ and $p=\gamma(s)$ and $q=\gamma(t)$.

Let $z_p$ and $z_q$ be the $z$-coordinates of $p$ and $q$.

Since $\gamma|_{[s,t]}$ lies in the dark side,
its Liberman's development $\tilde\gamma|_{[s,t]}$ 
with respect to $\bm{k}$ is concave.
In particular 
\[\length(\gamma|_{[s,t]})
=
\length(\tilde\gamma|_{[s,t]})
\ge
\tfrac{z_q-z_p}{\cos\phi(s)}.\]

On the other hand, convexity of $\sigma_+$ imply that
\[\length\sigma_+\le \tfrac{z_q-z_p}{\cos\psi(t)}.\]
It remains to apply Observation~\ref{obs:cut}.
\qeds

\section{$s$-pairs}

Let $\Sigma\subset \RR^3$ 
be a strongly convex surface
and $\gamma\:[0,\ell]\to\Sigma$ be an elevating minimizing geodesic.

After rotating $(x,y)$-plane if necessary, 
we can assume that the border of shadow in the directions of $x$-axis, say $\omega_x$, 
is a smooth curve and $\gamma$ intersects them transversely.

Let $t_1<t_2<\dots<t_k$ be the time moments in $[0,\ell]$ 
at which $\gamma$ crossing $\omega_x$.
Note that 
\[\mu(t_n)=s_n\cdot e_x\ \ \text{for some}\ \  s_n=\pm1.\]

Set
\begin{align*}
\phi_n&=\phi(t_n)
&
\psi_n&=\psi(t_n)
&
\alpha_n&=\alpha(t_n)
\end{align*}

We say that a pair of indexes $i<j$
forms an \emph{$\bm{s}$-pair} 
if 
\[
\sum_{n=i}^js_n=0\ \ 
\text{and}\ \ 
\sum_{n=i}^{j'}s_n>0
\]
if $i<j'<j$.

Note that for any index $i$ appears in at most one $\bm{s}$-pair and 
for any $\bm{s}$-pair $(i,j)$ we have
\begin{itemize}
\item $s_i=1$; that is, $i$-th braket has to be openning.
 \item $s_j=-1$; that is, $j$-th braket has to be closing.
\end{itemize}
In particular,
\[s_i\cdot\alpha_i+s_j\cdot\alpha_j=\alpha_i-\alpha_j.\]

\parbf{Bracket interpretation.}
If you exchange ``$+1$'' and ``$-1$'' in $\bm{s}$ by ``$($'' and ``$)$'' correspondingly then $(i,j)$ is an $\bm{s}$-pair
if and only if the $i$-th bracket forms a pair with $j$-bracket.

\parbf{Embedded disc interpretation.}
Assume $(i,j)$ is an $\bm{s}$-pair.
Note that in this case there is an arc of $\omega_{\bm{i}}$
from $\gamma(t_i)$ to $\gamma(t_j)$
with monotonic $z$-coordinate.
Moreover this arc, say $\sigma$ together with $\gamma|{[t_i,t_j]}$ bounds an immesed disc in $\Sigma$.
That is there is an immesion $\iota\:\DD\to\Sigma$ 
such that the closed curve $\iota|_{\partial \DD}$ is formed by joint of $\sigma$ and $\gamma|{[t_i,t_j]}$.

The proof can be guessed from the diagram.
It shows a lift of $\gamma$ in the universal cover of strip of $\Sigma$ between horizontal planes through $\gamma(t_i)$ and $\gamma(t_j)$;
the solid vertical lines correspond are lifts of $\sigma$ and the dashed lines corresponds to the lifts of the other component of $\omega_{\bm{i}}$ bethween the planes.

We say that $q$ is the depth of an $\bm{s}$-pair $(i,j)$
(briefly $q=\depth_{\bm{s}}(i,j)$) 
if $q$ is the maximal number such that theis $q$-long nested sequence of $\bm{s}$-pairs starting with $(i,j)$; 
that is a sequence of $\bm{s}$-pairs
$(i,j)=(i_1,j_1),(i_2,j_2),\dots,(i_q,j_q)$ such that
\[i=i_1<\dots<i_q<j_q<\dots<j_1=j.\]

We say that $q$ is the depth of an $\bm{s}$-pair $(i,j)$
(briefly $q=\depth_{\bm{s}}(i,j)$) 
if $q$ is the maximal number such that theis $q$-long nested sequence of $\bm{s}$-pairs starting with $(i,j)$; 
that is a sequence of $\bm{s}$-pairs
$(i,j)=(i_1,j_1),(i_2,j_2),\dots,(i_q,j_q)$ such that
\[i=i_1<\dots<i_q<j_q<\dots<j_1=j.\]

Note that the $\bm{s}$-pair of the same depth do not overlap;
that is if for two distinct $\bm{s}$-pairs $(i,j)$ and $(i',j')$,
we have $\depth(i,j)=\depth(i',j')$
then either $i<j<i'<j'$ or $i'<j'<i<j$.

The following proposition follow directly from the definitions above.

\begin{thm}{Proposition}\label{prop:immersion}
Let $(i,j)$ be an $\bm{s}$-pair.
Then the arcs $\gamma|_{[t_i,t_j]}$ and an arc of $\omega_{\bm{i}}$ bound an immesed disc in $\Sigma$ which lies between horizontal planes through $\gamma(t_i)$ and $\gamma(t_j)$.
Moreover the maximal multiplicity of the disc is at most $\depth_{\bm{s}}(i,j)$.
\end{thm}


\begin{thm}{Corollary}\label{cor:Sq}
Let us denote by $S_q$  the subset of indiexes $\{1,\dots,k\}$
which are the parts of $\bm{s}$-pairs with depth $q$.
Then
\[\sum_{n\in S_q}s_n\cdot\alpha_n\le 4\cdot\pi\cdot q.\]
\end{thm}

\parit{Proof.} For each $n$ denote by $K_n$ the integral of Gauss curvature of the part of surface $\Sigma$ which lies below horizontal plane through $\gamma(t_n)$.
Note that 
\[0\le K_1\le\dots\le K_k\le 4\cdot\pi.\]


By Proposition~\ref{prop:immersion} and the Key Lemma,
we get
\[s_i\cdot\alpha_i+s_j\cdot\alpha_j=\alpha_i-\alpha_j\le q\cdot (K_j-K_i)\]

The statement follows since the $\bm{s}$-pairs with the same depth do not overlap.
\qeds

\begin{thm}{Corollary}\label{cor:gamma-0}
Assume 
\[q=\max_{1\le i<j\le k}\left\{\left|\sum_{n=i}^js_n\right|\right\}\]
Then
\[\left|\sum_{n=1}^k s_n\cdot\alpha_n\right|
\le 2\cdot q\cdot(q+\tfrac32)\cdot \pi.
\]
\end{thm}

\parit{Proof.}
Denote by $S$ the set of all indexes which appear in some $\bm{s}$-pair.

Note that depth of any $\bm{s}$ pair is at most $q$.
That is,
\[S=S_1\cup\dots\cup S_q.\]
By Corollary~\ref{cor:Sq},
\[\sum_{n\in S}s_n\cdot\alpha_n\le 2\cdot q\cdot(q+1)\cdot\pi.\eqlbl{sum-S}\]

Set $R=\{1,dots,k\}\backslash S$;
this is the set of indexes 
which do not appear in an $\bm{s}$-pair.

Given $r$, set $i\in Q_r$ 
if
\[\sum_{n=1}^is_n=r.\]
Note that $Q_r\ne\emptyset$ for at most $q$ values of $r$
and in each set $Q_r$ there are at most $2$ indexes 
which do not appear in an $\bm{s}$-pair;
that is $Q_r\cap R$ has at most two indexes for each $r$.

Sine $|a_n|<\tfrac\pi2$, we get
\[\left|\sum_{n\in R}s_n\cdot\alpha_n\right|
\le
q\cdot\pi.
\]
The later inequality together with \ref{sum-S} implies the statement in the corollary.
\qeds



\section{Geometric growth}\label{sec:geometric-growth}

\begin{thm}{Claim}\label{clm:alpha-psi}
Assume $\psi(t)>\eps$ for ant $t\in[t_{i},t_{j}]$
and $s_i+\dots+s_j=2$
Then 
\[|\alpha_j-\alpha_i|>\pi\cdot\sin\eps.\] 
\end{thm}


\begin{thm}{Claim}
Let $\gamma$
be elevating minimizing geodesic on a graph $z=f(x,y)$ of a concave function.
Then for any pair of indexes $j>i$,
such that 
\[|\sum_{n=i}^{j}s_n|\ge 5\]
we have
\[\phi_j>\tfrac32\cdot\phi_i.\]
\end{thm}


\parit{Proof.}
Without loss of generality, we may assume that 
\[\sum_{n=i}^{j}s_n= 6\]

Let $j'$ be the least index 
such that
\[|\sum_{n=i}^{j'} s_n|=5.\]

Note that for any $b>t_j$ there is $a\in[t_i,t_j]$
such that intrval $[a,b]$ satisfies the assumptions of Proposition~\ref{prop:phi-psi}.
In particular $\psi(b)>\phi_i$ for any $b>t_j$.
Applying Claim~\ref{clm:alpha-psi},
we get that $|\alpha_j|>\tfrac\pi2\cdot \phi_i$ or 
$|\alpha_{j'}|>\tfrac\pi2\cdot \phi_i$.
Since $\phi_n$ is nondecreasing,
and $\phi_n\ge |\alpha_n|$ for any $n$,
in both cases we get
\[\phi_j>\tfrac\pi2\cdot \phi_i.\]
\qeds


\section{An estimate for graphs}\label{sec:graph}

\begin{thm}{Proposition}
There is c constant $\omega'$ ($\omega'=10\cdot\pi$ will do)
such that
if $\gamma$ is an elevating minimizing geodesic on a graph $z=f(x,y)$
of a concave function $f$ then
\[\tc_{\bm{i}}\gamma\le \omega'.\]
\end{thm}

\parit{Proof.}
We can assume that
$\gamma$ cross the $\bm{i}$ horizon $\omega_{\bm{i}}$ tranfersally.
Let $t_1<\dots<t_k$ be the values of parameter at which $\gamma$ cross $\omega_{\bm{i}}$ 
and 
$s_1,\dots,s_k$ the signs as in ...

Recall that $S_q$ denotes the subset of indexes $\{1,\dots,k\}$
which appear in $\bm{s}$-pair with depph $q$.
According to Corollary~\ref{cor:Sq},
\[\left|\sum_{n\in S_q}s_n\cdot\alpha_n\right|\le 4\cdot q\cdot \pi.\]
In particular,
\[\left|\sum_{n\in S_1\cup\dots\cup S_5}
s_n\cdot\alpha_n\right|
\le 
40\cdot\pi.\]

Set $R=\{1,\dots,k\}\backslash (S_1\cup\dots\cup S_5)$;
this is the set of indexes which appear in $\bm{s}$-pairs with depth at least $6$ 
as well as those which do not appear in any $\bm{s}$-pair.

According to ???
\[\left|\sum_{n\in R}
s_n\cdot\alpha_n\right|\le \sum_{n\in R}\phi_n.\] 
To estimate the last sum will use the results in Section~\ref{sec:geometric-growth}.
First let us subdivide $R$ into 5 subsets $R_1,\dots,R_5$,
by setting 
$n\in R_m$ if $m\equiv n\pmod 5$.

Given $n\in R_m$, denote by $n'$ the least index in $R_m$ which is larger $n$;
$n'$ is defined for any $n\in R_m$ exept the largest one.
According to ??? $\phi_{n'}>2\cdot \phi_n$.
Since $\phi_n$ is nondecreasing in $n$,
we get 
\[\sum_{n\in R_m}\phi_n\le 2\cdot\phi_k.\]
It follows that 
\[\sum_{n\in R}\phi_n\le 10\cdot\phi_k< 5\cdot\pi.\]

According to Liberman's lemma
\begin{align*}
\tc_{\bm{i}}\gamma
&\le 
4\cdot\pi
+
2\cdot [s_1\cdot\alpha_1+\dots+s_k\cdot\alpha_k]\le 
\\
&\le 100\cdot \pi.
\end{align*}
\qeds



\section{Final assembling}


Assume there is a minimizing geodesic $\gamma\:[0,\ell]\to \Sigma$ in a convex surface $\Sigma\subset \RR^3$ such that
\[\tc\gamma=\omega.\]

According to ??? we can assume that $\Sigma$ is strongly convex.

According to ???, we can pass to an elevating arc, of $\gamma$ for some $(x,y,z)$-coordinate system with total curvature $>\tfrac{\omega}{10^6}$.
Rename this arc by $\gamma$ and let us use the notations in Section~\ref{sec:elevating}.

Rotating $(x,y)$-coordinate plane we can ensure that
\[\tc\gamma\le 10\cdot\tc_{\bm{i}}\gamma\]
and that $\gamma$ cross the horizon $\omega_{\bm{i}}$ transversally.

Let us subdivide $\gamma$ into three arcs lower middle and upper arcs $\gamma_-$, $\gamma_0$ and $\gamma_+$
the the following way.

Note that according to ??? $\gamma_+$ lies on a graph of concvae function.
By Proposition~\ref{prop:graph}, we get 
\[\tc_{\bm{i}}\gamma_+\le 100\cdot\pi.\eqlbl{+}\]
Similarly $\gamma_-$ lies on a graph of convex function and the same proposition implies 
\[\tc_{\bm{i}}\gamma_-\le 100\cdot\pi.\eqlbl{-}\]

By Corollary~\ref{cor:gamma-0},
\[\tc_{\bm{i}}\gamma_0\le 100\cdot\pi.\eqlbl{0}\]

\[\tc\gamma_0\le ???\]
Together with \ref{+} and \ref{-},
the later implies that 
\[\tc_{\bm{i}}\gamma\le 300\cdot\pi.\]
\qeds





\sloppy
\printbibliography[heading=bibintoc]
\fussy

\end{document}




Denote by $\Sigma_t$ the subset of $\Sigma$ which lies below $\gamma(t)$;
that is
\[\Sigma_t=\set{x\in \Sigma}{\langle x-\gamma(t),\bm{k}\rangle\le 0}.\]
Denote by $K_t$ the integral of Gauss curvature along $\Sigma_t$.
Note that $t\mapsto K_t$ is nondecreasing.




Set $K_n=K_{t_n}$. Note that $0\le K_0\le \dots\le K_k\le 4\cdot \pi$.

\begin{thm}{Proposition}\label{prop:s-pair}
Assume for some $(i,j)$ is an $\bm{s}$-pair.
Then
\[s_i\cdot\alpha_i+s_j\cdot\alpha_j\le (K_j-K_i)\cdot\depth_{\bm{s}}(i,j).\]

\end{thm}

\parit{Proof.}
Consider the closed curve formed by the arc $\gamma|_{[t_i,t_j]}$ and the arc of $\omega_{\bm{i}}$ from $\gamma(t_i)$ to $\gamma(t_j)$.
Note that it forms the boundary of immersed $\iota\:\DD\looparrowright\Sigma$ 
which lies between the horizontal planes through $\gamma(t_i)$ and $\gamma(t_j)$
and it overlaps at most $\depth_{\bm{s}}(i,j)$ times;
that is for any any $p\in\Sigma$ the set $\iota^{-1}(\{p\})$ contains at most $\depth_{\bm{s}}(i,j)$ points.

Applying Key lemma, the statement follows.
\qeds















Set $R=\{1,\dots,k\}\backslash (S_1\cup\dots\cup S_5)$;
this is the set of indexes which do not appear in any $\bm{s}$-pairs
as well as the indexes which appera in $\bm{s}$-pairs of depth at least $6$.

According to ???, the theorem will follow if we can find an universal upper bound on 
\[|\sum_{n\in R}s_n\cdot \alpha_n|.\]

Further let us subdivide $R$ into $R_1,\dots R_5$,
by setting 
\[R_r=\set{n\in R}{s_1+\dots+s_n\equiv r\pmod 5}.\]


Consider yet two more angle functions.
\begin{itemize}
\item Let $\phi(t)=\measuredangle(\dot\gamma(t),\bm{k})$. Set $\phi_n=\phi(t_n)$.
\item Let $\psi(t)$ be the signed angle between $\nu(t)$ and $(x,y)$-plane. 
Set $\psi_n=\psi(t_n)$.
\end{itemize}
Note that 
\[\phi(t)\ge |\psi(t)|\ \ \text{and}\ \  \phi(t)\ge |\alpha(t)|\] 
for any $t$.
In particular 
\[\phi_n\ge |\psi_n|\ \ \text{and}\ \  \phi_n\ge |\alpha_n|\]
for any $n$.
It follows that
\[|\sum_{n\in R}s_n\cdot \alpha_n|\le \sum_{n\in R}\phi_n.\]
Given $n\in R_r$, denote by $n'$ the lest index in $R_r$ bigger than $n$.
Our aim is to show that $\phi_{n'}\ge 2\cdot\phi_n$.
In this case 

Since $\phi_n\le \pi$, we will get
\[\sum_{n\in R_r}\phi_n\le 2\cdot \pi.\]

\parbf{Horizontal rotation.}
Note that $\mu(t)$ is horizontal for any $t$.

Define the rotation $\rho[a,b]$  
of the interval $[a,b]\subset[0,\ell]$
as the
algebraic rotation of $\mu(t)$ around the origin in $(x,y)$-plane;
say it can be defined by the formula 
\[\rho_{[a,b]}
=
\int\limits_a^b \<\mu(t),\mathrm{J}(\dot\mu(t))\>\cdot dt,\]
where $\mathrm{J}\:\RR^2\to\RR^2$ denotes the rotation by angle $\tfrac\pi 2$ around the origin.

Note that 
\[\rho[t_i,t_{i+1}]=\tfrac\pi2\cdot(s_i+s_{i+1}).\]

\begin{thm}{Claim}
Assume that 
\[\gamma_z(t_i)\ge \tfrac12\cdot(\gamma_z(\ell)+\gamma_z(0))\ \ \text{and}\ \ \left|\sum_{n=i}^js_n\right|=6.\]
Then $\psi(t)>0$ for any $t\ge t_j$.
\end{thm}

Note that the claim implies that from $t_j$,
the geodesic $\gamma$ 
lies on a graph $z=f(x,y)$ of a concave function $f\:\RR^2\to\RR$
and forms a minimizing geodesic in this graph.
Indeed fix $\eps>0$ such that $\psi(t)>\eps$
for any $t\ge t_j$.
Consider the set $W$ which lies under all the supporting planes 
such that its outer normal vector forms angle at most 
$\tfrac\pi2-\eps$ with the vertical direction.
Note that the set $W$ forms a subgraph $z\le f(x,y)$ 
of a  concave $(\mathop{\rm ctg} \eps)$-Lipschitz function $f\:\RR^2\to \RR$
and all the points of $\gamma$ lie the graph $z=f(x,y)$

\parit{Proof.}
Assume contrary, that is $\phi(t)\le 0$ for some $t\ge t_j$.
Let us draw the half-plane $\Pi_+$ through $\gamma(t)$ bounded by the $z$-axis.
Denote by $\Pi_-$ the opposite half-plane for $\Pi_+$ .

Note that there are two values $t_+<t_-$ in $[t_i,t_j]$
such that $\gamma(t_\pm)\in \Pi_\pm$.

Consider the sub-arc $\sigma$ 
of $\Sigma\cap\Pi$ from $\gamma(t)$
to $\gamma(t')$.
Since $\gamma$ is minimizing we have that 
\[\length \gamma|_{[t',t]}\le \length\sigma.\]

The later contradicts straightforward estimates.
Namely assume 
$a$ and $a_+$ be the distances from $\gamma(t)$ and $\gamma(t_+)$ to the $z$-axis.
Further set $b=\langle \gamma(t)-\gamma(0),\bm{k}\rangle$ 
and 
$b_+=\langle \gamma(t)-\gamma(0),\bm{k}\rangle$.
By the assumptions we have $b\le 2\cdot b_+$;
it follows that  $a_+\le a\le 2\cdot a_+$
and therefore 
\[(\length\sigma)^2\le (b-b_+)^2+a_+^2.\]
On the other hand, since $t_+<t_-<t$ we get that 
\[(\length\gamma|_{[t_+,t]})^2\ge (b-b_+)^2+(a+a_+)^2.\]
\qeds

Note that the last claim imply the following.

\begin{thm}{Proposition}\label{prop:graph}
Assume Main Theorem does not hold;
that is, there is a sequence of convex surfaces $\Sigma_n$
and a sequence of minimizing geodesic $\gamma_n$ in $\Sigma_n$ such that 
\[\tc \gamma_n\to\infty\ \ \text{as}\ \ n\to\infty.\]

Then we can make in addition one of the following assumtions:

\begin{enumerate}[(i)]
\item\label{graph} $\Sigma_n$ is a graph $z=f_n(x,y)$ of a smooth convex function $f_n\:\RR^2\to\RR$
and $\dot\gamma_z(t)>0$ for any $t\in[0,\ell]$. 
\item\label{finite} $\left|\sum_{n=i}^js_n\right|<10$ for any $i<j$.
\end{enumerate} 
\end{thm}

In particular, from now on $\psi(t)>0$ for any $t\in[0,\ell]$.
Note also that by Liberman's lemma $\phi(t)$ is a nondecreasing function on $[0,\ell]$.
The two cases (\ref{graph}) and (\ref{finite}) will be done separetely.
The case (\ref{graph}) is more involved.

\begin{thm}{Claim}
Let $[a,b]\subset[0,\ell]$ and $\rho[a,b]\ge 3\cdot\pi$.
Then $\psi(t)\ge \phi(a)$ for any $t\ge b$.
\end{thm}


\begin{thm}{Claim}
Assume  
$\psi(t)\ge \eps>0$ for any $t\in [a,b]$.
Then 
$\alpha(b)-\alpha(a)>\eps\cdot\rho[a,b]$.
In particular, either $|\alpha(a)|>\tfrac12\cdot\eps\cdot\rho[a,b]$ or $|\alpha(b)|>\tfrac12\cdot\eps\cdot\rho[a,b]$.
\end{thm}

Note that above two claims imply the following.

\begin{thm}{Proposition}
Assume $\gamma$ as in Proposition \ref{prop:graph}
and for some $i<j$ we have
\[\left|\sum_{n=i}^js_i\right|=5\]
Then $\phi_j>2\cdot\phi_i$.
\end{thm}













We will assume that the lines parallel to $\bm{u}$ become vertical in the $(x,y)$-plane,
so that the development $\tilde\gamma$ is always a graph.
We say that development is convex (concave) on some arc if it is descrived by convex (correspondingly concave) function on this arc.


Let $\Sigma$ be a smooth strongly convex surface in $\RR^3$
and $\gamma\:[0,\ell]\to\Sigma$ be a unit-speed geodesic.
Given a point $p\in\RR^3$, set $f_p(t)=|\gamma(t)-p|^2$
Then the following two expressions have the opposite  signs
\[f_p''(t)-2
\ \ \text{and}
\ \ \langle\nu_{\gamma(t)},\gamma(t)-p\rangle.
\]
In particular, if $p$ lies inside of $\Sigma$ then $f_p''(t)-2<0$ for any $t$.

Given a unit vector consider the function $h_{\bm{u}}=\langle\gamma(t),\bm{u}\rangle$.
Then the following two expressions have the opposite signs
\[h_{\bm{u}}''(t)
\ \ \text{and}
\ \ \langle\nu_{\gamma(t)},\bm{u}\rangle.
\]


Assume $\gamma$ is a geodesic on smooth convex surface $\Sigma\subset \RR^3$.

Let $\gamma$ be a curve and $\bm{u}$ is a unit vector in $\RR^3$.
Concider the cylindrical surface formed by all the lines parallel to $\bm{u}$ which pass through points of $\gamma$.
This surface is flat and it can be developed isometrically on the plane. 
The image 
of $\gamma$ is called Liberman's development of $\gamma$ in the direction of $\bm{u}$;
it will be denoted by $\tilde\gamma_{\bm{u}}$.
(Formally, to perform this construction,
we have to assume that $\dot\gamma$ is not collinear with $\bm{u}$,
and the general case the construction is done by approximation.)


Let $\Sigma$ be convex surface and $p\in \Sigma$.
We say that $p$ lies on the \emph{dark} (\emph{light}) side of $\Sigma$ with respect to $\bm{u}$, if the points $p+t\cdot\bm{u}$ (correspondingly $p-t\cdot\bm{u}$) lie outside of $\Sigma$ for all $t>0$.
The intersection of dark and light side is called \emph{horizon} with respect to $\bm{u}$;
it will be denoted by $\omega_{\bm{u}}$.
If $\Sigma$ is strongly and smooth convex then $\omega_{\bm{u}}$ is a smooth curve.

\begin{thm}{Lemma}
Let $\gamma$ be a geodesic on a convex surface $\Sigma\subset\RR^3$ and $\bm{u}$ is a unit vector.
Then the arc $\tilde\gamma_{\bm{u}}|_{[a,b]}$ of Liberman develpoment $\tilde\gamma_{\bm{u}}$
is convex (concave) if and only if the corresponding arc $\gamma|_{[a,b]}$ 
lies on the light (correspondingly dark) side of $\Sigma$ with respecto to $\bm{u}$.
\end{thm}

The proof of the estimate on the total curvature of geodesic on convex surface given by Liberman in \cite{liberman} is based on the observation that the total curvature of concave as well as convex graph
can not exceed $\pi$.


\parbf{Conical Liberman lemma.} Inseted of cylindrical surface,
one can consider the conical surface with given tip $z\notin \gamma$ trough $\gamma$.
The conical surface is flat and it can be developed isometrically on the plane
and the image of $\gamma$ is called \emph{Liberman's development} with repsct to point $z$.

\begin{thm}{Lemma}
Assume the point $z$ lies inside the convex surface $\Sigma$.
Then Liberman development with respect to point $z$
of any geodesic $\gamma$ on $\Sigma$ is locally convex.
\end{thm}





A curve $\tilde\gamma$ in $(x,y)$-plane is called \emph{Librman's development} of $\gamma$ in the direction of $\bm{u}$
if there is a legth-preserving $\iota\:\RR^2\to\RR^3$
such that $\gamma=\iota\circ \tilde\gamma$ and $\iota$ is cylindrical in the direction of $\bm{u}$; the is
$\iota(x,y_1)-\iota(x,y_0)=(y_1-y_0)\cdot\bm{u}$
for any $x,y_0$ and $y_1$.

Let $\Sigma$ be a smooth convex hypersurface in the Euclidean space.

Given a point $p\in \Sigma$, we will denote by $n_p$ the outer normal vector of $\Sigma$ at $p$;
the map $\Sigma\to\SS^2$ defined as $p\mapsto n_p$ sometimes is called \emph{Gauss map}.

Given a unit vector $\bm{u}$,
we say that a point $p\in \Sigma$
lies on the \emph{dark} (\emph{light}) side of $\Sigma$ with respect to $\bm{u}$, if $\langle\bm{u},n_p\rangle\ge0$ (correspondingly $\langle\bm{u},n_p\rangle\le0$).
If $\langle\bm{u},n_p\rangle=0$, we say that $p$ lies on the \emph{horizon} with respect to $\bm{u}$.
The horizon with respect to $\bm{u}$ will be denoted by $\omega_{\bm{u}}$;
if $\Sigma$ is strongly convex then $\omega_{\bm{u}}$ is a smooth curve.

Fix a points $z\notin\Sigma$.
Given a point $p\in \Sigma$,
we say that $p$ lies on light (dark) side from $z$ if 
if $\langle z-p,n_p\rangle\le 0$ (correspondingly $\langle z-p,n_p\rangle\ge 0$).
If $\langle z-p,n_p\rangle= 0$ we say that $p$ lies on the horizon
from $p$.
Note that if $z$ lies inside of $\Sigma$ then all points on $\Sigma$ lie on the dark side from $z$.

Let $\gamma$ be a space curve 
parametrized by length.
Fix a point $z\notin\gamma$. 
Let us define \emph{Liberman's development} of $\gamma$ with respect to $z$ as the unit-speed plane cure $\tilde\gamma_z$ such that the direction $\tilde\gamma_z(t)$
changes counterclockwise as $t$ changes
and
$|\tilde\gamma_p(t)|=|\gamma(t)-z|$ for any $t$.

The Liberman's development $\tilde\gamma_z$ is called convex concave at $\tilde\gamma_z(t)$ if there the curvelinear triangle ??? 


Assume $\gamma$ is a smooth curve in $\RR^3$ and $\bm{u}$ is a unit vector.
Concider the cylindrical surface formed by all the lines parallel to $\bm{u}$ passing through the points on $\gamma$.


Let $\Sigma$ be a convex surface in the Euclidean space 
$z\not\in\Sigma$ and $\gamma$ be a unit-speed geodesic in $\Sigma$.
Then the development $\tilde\gamma_z$ is locally convex (concave) 
at the points on dark (light) side of $\Sigma$ with respect to $z$.


Assume $\gamma\:[0,\ell]\to \Sigma$ is a unit-speed curve in the space.

The vector $\ddot\gamma(t)$ is the curvature vector of $\gamma$ at $t$.
The total curvature of $\gamma$ can be defined as 
\[\tc\gamma\df\int\limits_0^\ell|\ddot\gamma(t)|\cdot dt.\]

The total curvature of $\tilde\gamma_z$ 
is called the total curvature of $\gamma$ in the direction of $z$ 
and denoted as $\tc_z\gamma$
Given a point $z$, let us define the total curvature of $\gamma$ in the direction of $z$ as
\[\tc_z\gamma
\ge
\int\limits_0^\ell
\left|
\langle\ddot\gamma(t),\tfrac{z-\gamma(t)}{|z-\gamma(t)|}\rangle
\right|
\cdot dt.\]
















Assume that one of the arcs of $\omega_{\bm{u}}$ from $\gamma(a)$ and $\gamma(b)$, 
say $\omega_{\bm{u}}^+$, together with $\gamma$ bound a disc in $\Sigma$.
In particular,
\[\tc_{\bm{u}}\gamma
\le
\int\limits_{\Omega} K\cdot d\area\]



\begin{thm}{Key Lemma}
\label{lem:key}
Let $\gamma\:[0,\ell]\to \Sigma$ be a geodesic on the convex surface in the Euclidean space 
and $u\in\SS^2$.
Assume that $0=t_0<t_1<\dots<t_n=\ell$ be the values such that each arcs $\gamma|_{[t_{i-1},t_i]}$ alternating light and dark side of $\Sigma$ with respect to $u$.
Set $\alpha_i=\measuredangle(\dot\gamma(t_i),u)$
Then 
\[\tc_u\gamma=|\sum_i(-1)^i\alpha_i|.\]

Moreover, if $1<i<n$ 
and $\Omega_i$ denotes the domain of $\Sigma$ bounded by the arc $\gamma|_{[t_{i-1},t_i]}$ and the $u$-horizon then 
\[|\alpha_i-\alpha_{i-1}|\le \curv\Omega_i,\]
where $\curv\Omega_i$ denotes the total curvature of $\Omega_i$.
In particular,
\[\tc_u\gamma\le 4\cdot\pi+\sum_i\curv\Omega_i.\]
\end{thm}

\parbf{Remarks.}
Clearly $\tc_z\gamma\le \tc \gamma$ for any curve $\gamma$ in $\Sigma$.

On the other hand given few points $z_i$ which do not lie in one plane
one can estimate $\tc\gamma$ 
in terms of $\tc_{z_i}\gamma$ 
the distances between $z_i$ and the maximal distance to $\gamma$.

Let $N=N(\Sigma,\gamma, u)$ be the maximal integer such that at most $N$ of the domains $\Omega_i$ intersect at one point.
Note that from \cite{BKZ}, it follows that the value $N$ can take arbitrary large value.
The number $N$ can be estimated through the maximal rotation number of subarcs of $\gamma$ with respect to the lines.
In particular the total curvature of geodesic $\gamma$ 
can be bounded in terms of maximal rotation number of subarcs of $\gamma$ around the lines.
The later was claimed in \cite{BKZ} without a proof.

Then
\[\sum_{i=2}^{n-1}\curv\Omega_i
\le 
N\cdot\curv\Sigma
\le 
4\cdot N\cdot\pi.\]
Therefore, we get an estimate
\[\tc_u\gamma
\le 
4\cdot N\cdot\pi+|\alpha_0-\alpha_1|+|\alpha_{n-1}-\alpha_n|
\le
(4\cdot N+2)\cdot\pi.\]
Since the same holds for any vector $u$,
we can taking avarage we get
\[\tc\gamma\le 3\cdot(4\cdot N+2)\cdot\pi.\]